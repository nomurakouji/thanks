<%= stylesheet_link_tag 'users', media: 'all', 'data-turbolinks-track': 'reload' %>

<div class = "box">
  <div class = "box-inner">
    <h1>ユーザー一覧</h1>
    <div class = "search-box">
      <%= search_form_for @q, url: users_path do |f| %>
        <%= f.label :name_or_email, "ユーザー名orメールアドレス" %>
        <%= f.search_field :name_or_email_cont %>
        <%= f.submit '検索'%>
      <% end %>
    </div>

    <table class="table table-hover">
        <tr>
          <th><%= sort_link(@q, :id, "ユーザーID") %></th>
          <th><%= sort_link(@q, :name, "部門名") %></th>
          <th><%= sort_link(@q, :name, "ユーザー名") %></th>
          <th><%= sort_link(@q, :email, "email") %></th>
          <th>フォロー</th>
          <th>メッセージ</th>
        </tr> 
      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td><%= user.id %></td>
            <td><%= user.department.name %></td> 
            <td><%= user.name %></td>
            <td><%= user.email %></td>
            <% if  current_user.id == user.id  %>
              <td>-</td>
            <% else %>
              <td><div id="follow_form_"><%= render 'follow_form', user: user %> </div></td>
            <% end %>
            
            <% if  current_user.id == user.id  %>
              <td>-</td>
            <% else %>
              <td> <%= link_to 'メッセージ', conversations_path(sender_id: current_user.id, recipient_id: user.id), method: :post %></td>
            <% end %> 
            
          </tr>
        <% end %>
      </tbody>
    </table>
    <%= paginate @users %>
  </div>
</div>



